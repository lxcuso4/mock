webpackJsonp([2],{Xh5U:function(t,e){},eRBi:function(t,e,a){"use strict";function s(t,e){var a=null,i=n(t),r=["array","object"].indexOf(i);if(-1!==r){switch(r){case 0:a=[],t.forEach(function(t,n){var i=s(t,e);a[n]=i});break;case 1:for(var o in a={},t)if(t.hasOwnProperty(o)){var c=s(t[o],e);"underscore2camelCase"===e&&(o=o.replace(/_(\w)/g,function(t,e){return e.toUpperCase()})),a[o]=c}}return a}return-1!==["number","string","null","undefined","boolean"].indexOf(n(t))&&(a=t),a}function n(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function i(t){var e="";try{e=JSON.parse(t)}catch(e){return t}return e}a.d(e,"a",function(){return s}),a.d(e,"b",function(){return i})},o1nK:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),n=a.n(s),i=a("woOf"),r=a.n(i),o=a("Dd8w"),c=a.n(o),l=a("NYxO"),u=(a("TjCw"),a("eRBi")),d=a("fZjL"),h=a.n(d),p={data:function(t,e){try{t=JSON.parse(t)}catch(t){return e||this.$notify.error({title:"json格式错误",message:t}),!1}return t},url:function(t,e){return!!/^\/[^\s]+$/g.test(t)||(e||this.$notify.error({title:"url格式错误",message:t}),!1)},newUrl:function(){var t;return(t=p.url).call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))},page:function(t,e){return!(t&&!/^\d+$/g.test(t))||(e||this.$notify.error({title:"页码格式错误",message:t}),!1)},opt:function(t,e){return!(t.weight&&!/^\d+$/g.test(t.weight))||(e||this.$notify.error({title:"opt格式错误",message:n()(t)}),!1)}},f={methods:{test:function(t,e,a){var s=this;return"boolean"==typeof e&&(a=e,e=null),(e=e||h()(t)).every(function(e){if("function"==typeof p[e]){var n=p[e].call(s,t[e],a);return"boolean"!=typeof n&&(t[e]=n),n}return!0})}}},m={data:function(){return{addJson:{url:"",data:""},autosize:[],searchSize:[],key:"",timer:null,searchLoading:0,searchApiList:[],allJsonData:{}}},computed:c()({},Object(l.c)(["addFlag","currentStore","storeList"]),{currentJsonData:{get:function(){return this.allJsonData[this.currentStore.store]||{currentPage:1,totalPage:1,allApiList:{}}},set:function(t){t=r()({},this.currentJsonData,t),this.$set(this.allJsonData,this.currentStore.store,t)}},showApiList:function(){return this.currentJsonData.allApiList[this.currentJsonData.currentPage]||[]}}),watch:{key:function(t){this.searchInit(t)}},beforeRouteEnter:function(t,e,a){a(function(e){console.log("beforeRouteEnter"),e.initStore(t)})},beforeRouteUpdate:function(t,e,a){log("beforeRouteUpdate"),this.initStore(t),a()},created:function(){window.home=this},mixins:[f],methods:{searchInit:function(t,e){var a=this;t?(this.timer&&clearTimeout(this.timer),this.searchLoading=1,this.timer=setTimeout(function(){a.post("/api/search",{userId:a.currentStore.id,key:t,limitNums:10}).then(function(t){t.data&&t.data.length?(a.searchLoading=3,a.searchApiList=t.data.map(a.mat)):a.searchLoading=2})},e?0:100)):this.searchLoading=0},selectPage:function(t){this.currentJsonData={currentPage:t},this.getApiList(this.currentStore,t)},reset:function(t,e){var a=this;"blur"===e?this.$set(this.autosize,t%1e3,{minRows:1,maxRows:2}):this.$set(this.autosize,t%1e3,{minRows:1,maxRows:1e3}),this.$nextTick(function(){a.$refs.input[t].resizeTextarea()})},resetSearch:function(t,e){var a=this;"blur"===e?this.$set(this.searchSize,t%1e3,{minRows:1,maxRows:2}):this.$set(this.searchSize,t%1e3,{minRows:1,maxRows:1e3}),this.$nextTick(function(){a.$refs.searchInput[t].resizeTextarea()})},initStore:function(t){var e=t.params.store||"default",a=this.storeList.filter(function(t){return t.store==e})[0]||{};this.commit("currentStore",a),this.initCurrentPageApi(a)},initCurrentPageApi:function(t){t.store&&(this.allJsonData[t.store]||(this.$set(this.allJsonData,t.store,{currentPage:1,totalPage:1,allApiList:{}}),this.getApiList(t,1)))},getApiList:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t.id&&this.post("/api/query",{userId:t.id,page:a,count:50}).then(function(s){e.$set(e.allJsonData[t.store],"totalPage",s.data.totalPage),e.$set(e.allJsonData[t.store].allApiList,a,s.data.jsonList.map(e.mat))})},add:function(){var t=this,e=this.currentStore,a=this.currentJsonData,s={userId:e.id,url:this.addJson.url,data:n()(this.addJson.data)};this.test(s)&&this.post("/api/add",s).then(function(s){t.getApiList(e,a.currentPage),t.tip("新增成功")})},clean:function(){this.addJson.data="",this.addJson.url=""},rm:function(t){var e=this,a=this.currentStore,s=this.currentJsonData;this.post("/api/rm",{url:t,userId:a.id}).then(function(t){e.getApiList(a,s.currentPage),e.key&&e.searchInit(e.key,!0),e.tip("删除成功")})},update:function(t,e,a){var s=this,i=this.currentStore,r=this.currentJsonData,o={userId:i.id,url:t,data:n()(e),newUrl:a};this.test(o)&&this.post("/api/update",o).then(function(t){t.data.n?(s.tip("更新成功"),s.getApiList(i,r.currentPage),s.key&&s.searchInit(s.key,!0)):s.tip(t.msg,"error")})},mat:function(t){return t.data=n()(Object(u.b)(t.data),null,2),t.newUrl=t.url,t}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-main",{staticClass:"main-box"},[a("transition",{attrs:{"enter-active-class":"animated animated-fast slideInDown","leave-active-class":"animated animated-fast slideOutUp"}},[a("el-card",{directives:[{name:"show",rawName:"v-show",value:t.addFlag,expression:"addFlag"}],staticClass:"box-card add-box"},[a("div",{staticClass:"header"},[a("div",{staticClass:"url-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.addJson.url,expression:"addJson.url"}],attrs:{type:"text",placeholder:"请输入接口地址"},domProps:{value:t.addJson.url},on:{input:function(e){e.target.composing||t.$set(t.addJson,"url",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"edit"},[a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-upload",circle:""},on:{click:t.add}}),t._v(" "),a("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-minus",circle:""},on:{click:t.clean}})],1)]),t._v(" "),a("div",{staticClass:"err-tip",domProps:{innerHTML:t._s(t.jsonlint(t.addJson.data))}}),t._v(" "),a("el-input",{attrs:{type:"textarea",autosize:{minRows:8},placeholder:"请输入json格式"},model:{value:t.addJson.data,callback:function(e){t.$set(t.addJson,"data",e)},expression:"addJson.data"}})],1)],1),t._v(" "),a("div",{staticClass:"search-box"},[a("el-row",[a("el-input",{attrs:{placeholder:"请输入url关键字",clearable:""},model:{value:t.key,callback:function(e){t.key=e},expression:"key"}})],1),t._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.key&&1==t.searchLoading,expression:"key && searchLoading==1"}]},[a("el-button",{staticClass:"loading",attrs:{type:"info",plain:"",loading:!0}},[t._v("搜索中...")])],1),t._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.key&&2==t.searchLoading,expression:"key && searchLoading==2"}]},[a("el-alert",{staticClass:"not-found",attrs:{title:"搜索结果为空",loading:!0,type:"warning",closable:!1,"show-icon":""}})],1),t._v(" "),t._l(t.searchApiList,function(e,s){return t.key&&3==t.searchLoading&&t.searchApiList&&t.searchApiList.length?a("div",{staticClass:"box-card search-list"},[a("el-card",[a("div",{staticClass:"header"},[a("div",{staticClass:"url-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.newUrl,expression:"item.newUrl"}],attrs:{type:"text",placeholder:"请输入接口地址"},domProps:{value:e.newUrl},on:{input:function(a){a.target.composing||t.$set(e,"newUrl",a.target.value)}}})]),t._v(" "),a("div",{staticClass:"edit"},[a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-upload",circle:""},on:{click:function(a){t.update(e.url,e.data,e.newUrl)}}}),t._v(" "),a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){t.rm(e.url)}}})],1)]),t._v(" "),a("div",{staticClass:"err-tip",domProps:{innerHTML:t._s(t.jsonlint(e.data))}}),t._v(" "),a("el-input",{key:s,ref:"searchInput",refInFor:!0,attrs:{clearable:"",type:"textarea",autosize:t.searchSize[s%1e3]||{minRows:1,maxRows:2},placeholder:"请输入json格式"},on:{focus:function(e){t.resetSearch(s,"focus")},blur:function(e){t.resetSearch(s,"blur")}},model:{value:e.data,callback:function(a){t.$set(e,"data",a)},expression:"item.data"}})],1)],1):t._e()})],2),t._v(" "),t._l(t.showApiList,function(e,s){return a("div",{staticClass:"box-card"},[a("el-card",[a("div",{staticClass:"header"},[a("div",{staticClass:"url-box"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.newUrl,expression:"item.newUrl"}],attrs:{type:"text",placeholder:"请输入接口地址"},domProps:{value:e.newUrl},on:{input:function(a){a.target.composing||t.$set(e,"newUrl",a.target.value)}}})]),t._v(" "),a("div",{staticClass:"edit"},[a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-upload",circle:""},on:{click:function(a){t.update(e.url,e.data,e.newUrl)}}}),t._v(" "),a("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){t.rm(e.url)}}})],1)]),t._v(" "),a("div",{staticClass:"err-tip",domProps:{innerHTML:t._s(t.jsonlint(e.data))}}),t._v(" "),a("el-input",{key:s,ref:"input",refInFor:!0,attrs:{clearable:"",type:"textarea",autosize:t.autosize[s%1e3]||{minRows:1,maxRows:2},placeholder:"请输入json格式"},on:{focus:function(e){t.reset(s,"focus")},blur:function(e){t.reset(s,"blur")}},model:{value:e.data,callback:function(a){t.$set(e,"data",a)},expression:"item.data"}})],1)],1)}),t._v(" "),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.currentJsonData.totalPage,expression:"currentJsonData.totalPage"}],staticClass:"pagination",attrs:{background:"",layout:"prev, pager, next","page-count":t.currentJsonData.totalPage},on:{"current-change":t.selectPage}})],2)},staticRenderFns:[]};var g=a("VU/8")(m,v,!1,function(t){a("Xh5U")},"data-v-7728b30a",null);e.default=g.exports}});
//# sourceMappingURL=2.62083f23fcebf100e24b.js.map